<?xml version="1.0" encoding="UTF-8"?>

<!--
WiX Toolset Pills 15mg
Copyright (C) 2019-2021 Dust in the Wind

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->


<!--
====================================================================================================
Step 1: Add bal namespace.
====================================================================================================

Bal extension is part of the WiX package.

Go To: Bundle.wxs (below in this file)
-->
<Wix
    xmlns="http://schemas.microsoft.com/wix/2006/wi"
    xmlns:bal="http://schemas.microsoft.com/wix/BalExtension">

    <Bundle
        Name="Bundle with Start Condition"
        Version="1.0.0.0"
        Manufacturer="Dust in the Wind"
        UpgradeCode="e57e5cb9-ab90-475c-b757-1b2cc26df1d2">

        <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense" />

        <bal:Condition Message="Sorry, you are not allowed to install the bundle.">
            <!--
            ====================================================================================================
            Step 3: Create the condition
            ====================================================================================================
            
            In this example, the condition is based on the "AllowToInstall" variable (created below):
                - if it is "yes", the bundle is allowed to be installed;
                - any other value will prevent the bundle to be installed.
            
            If the condition is false, the text from the "Message" attribute is displayed to the user.
            
            END
            -->

            <![CDATA[AllowToInstall = "yes"]]>
        </bal:Condition>

        <!--
        ====================================================================================================
        Step 2: Create the "AllowToInstall" variable
        ====================================================================================================
            
        This variable will control if the bundle is allowed to be installed or not.
        The attribute bal:Overridable="yes" is needed in order to allow the variable to be set from command line.
        
        Go To: Bundle.wxs (above in this file)
        -->
        <Variable
            Name="AllowToInstall"
            Type="string"
            Value="yes"
            Persisted="no"
            bal:Overridable="yes" />

        <Chain>
            <MsiPackage SourceFile="$(var.Installer1.TargetDir)$(var.Installer1.TargetName).msi" />
            <MsiPackage SourceFile="$(var.Installer2.TargetDir)$(var.Installer2.TargetName).msi" />
        </Chain>

    </Bundle>

</Wix>